{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Frame Sampling Webhook Payload Schema",
  "description": "JSON schema for webhook payloads in frame sampling and incident detection system",
  "type": "object",
  "required": ["event", "timestamp", "source", "data", "meta"],
  "properties": {
    "event": {
      "type": "string",
      "description": "Type of event being reported",
      "enum": [
        "frame_sampled",
        "incident_detected", 
        "processing_completed",
        "processing_failed",
        "alert_triggered",
        "system_health_check"
      ]
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO8601 timestamp when the event occurred"
    },
    "source": {
      "type": "object",
      "required": ["system", "version"],
      "properties": {
        "system": {
          "type": "string",
          "description": "Name of the system generating the webhook"
        },
        "version": {
          "type": "string",
          "description": "Version of the system generating the webhook"
        },
        "instance_id": {
          "type": "string",
          "description": "Unique identifier for the system instance"
        },
        "region": {
          "type": "string",
          "description": "Geographic region or deployment zone"
        }
      }
    },
    "data": {
      "type": "object",
      "description": "Event-specific payload data",
      "properties": {
        "session_id": {
          "type": "string",
          "description": "Unique identifier for the processing session"
        },
        "video_id": {
          "type": "string",
          "description": "Identifier for the source video"
        },
        "frame_id": {
          "type": "string",
          "description": "Unique identifier for the specific frame"
        },
        "sampling_strategy": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": ["uniform", "adaptive", "keyframe", "motion_based", "custom"]
            },
            "interval": {
              "type": "number",
              "description": "Sampling interval (frames or seconds)"
            },
            "parameters": {
              "type": "object",
              "description": "Strategy-specific parameters"
            }
          }
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence score for detection/analysis"
        },
        "cost_metrics": {
          "type": "object",
          "properties": {
            "processing_time_ms": {
              "type": "number",
              "description": "Time taken to process in milliseconds"
            },
            "compute_units": {
              "type": "number",
              "description": "Computational resources consumed"
            },
            "api_calls": {
              "type": "integer",
              "description": "Number of API calls made"
            }
          }
        }
      }
    },
    "meta": {
      "type": "object",
      "required": ["request_id"],
      "properties": {
        "request_id": {
          "type": "string",
          "description": "Unique identifier for this webhook request"
        },
        "correlation_id": {
          "type": "string",
          "description": "Identifier to correlate related events"
        },
        "retries": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of retry attempts for this webhook"
        },
        "priority": {
          "type": "string",
          "enum": ["low", "medium", "high", "critical"],
          "description": "Priority level of the event"
        },
        "schema_version": {
          "type": "string",
          "description": "Version of the payload schema"
        }
      }
    },
    "signature": {
      "type": "string",
      "description": "HMAC-SHA256 signature for payload verification"
    }
  }
}
